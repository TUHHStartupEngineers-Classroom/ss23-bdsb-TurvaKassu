```{r}
# Data Science at TUHH ------------------------------------------------------
# SALES ANALYSIS ----

# 1.0 Load libraries ----
library(tidyverse)
library(readxl)

# 2.0 Importing Files ----
bikes_tbl <- read_excel(
  "C:\\Users\\kaspe\\BusinessData\\ss23-bdsb-TurvaKassu\\Tidyverse\\bikes.xlsx")
bikeshops_tbl <- read_excel(
  "C:\\Users\\kaspe\\BusinessData\\ss23-bdsb-TurvaKassu\\Tidyverse\\bikeshops.xlsx")
orderlines_tbl <- read_excel(
  "C:\\Users\\kaspe\\BusinessData\\ss23-bdsb-TurvaKassu\\Tidyverse\\orderlines.xlsx")

# 3.0 Examining Data ----
bikes_tbl  %>% head(5)
bikeshops_tbl %>% head(5)
orderlines_tbl %>% head(5)


# 4.0 Joining Data ----
merged_orderlines <- orderlines_tbl %>% 
  left_join(bikes_tbl, by = c("product.id" =  "bike.id")) %>%
  left_join(bikeshops_tbl, by = c("customer.id" = "bikeshop.id"))

head(merged_orderlines, 5)

# 5.0 Wrangling Data ----
bike_orderlines_wrangled_tbl <- merged_orderlines %>%
  # 5.1 Separate category name
  separate(col    = category,
           into   = c("category.1", "category.2", "category.3"),
           sep    = " - ") %>%
  mutate(total.price = price * quantity) %>%
  select(-ends_with(".id")) %>%
  bind_cols(merged_orderlines %>% select(order.id)) %>%
  select(order.id, contains("order"), contains("model"), contains("category"),
         price, quantity, total.price,
         everything()) %>%
  rename(bikeshop = name) %>%
  set_names(names(.) %>% str_replace_all("\\.", "_"))

bike_orderlines_wrangled_tbl %>% head(5)

# 6.0 Business Insights ----
# 6.1 Sales by Year ----

# Step 1 - Manipulate

# Step 2 - Visualize


# 6.2 Sales by Year and Category 2 ----

# Step 1 - Manipulate

# Step 2 - Visualize



# 7.0 Writing Files ----

# 7.1 Excel ----

# 7.2 CSV ----

# 7.3 RDS ----

```
